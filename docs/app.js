"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}!function(t){var e={};function i(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==_typeof(t)&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t){i.d(a,r,function(e){return t[e]}.bind(null,r))}return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e){var i="http://www.w3.org/2000/svg";yodasws.page("home").setRoute({template:"pages/home.html",route:"/"}).on("load",function(){var t=new r(document.querySelector("svg#scene"),[{gradient:[1,0],delta:[0,0],width:20,color:"black"},{gradient:[1,0],delta:[20,0],width:20,rail:[1,1/4]},{gradient:[1,1],delta:[27,13],width:20,rail:[1,1/4]},{gradient:[0,1],delta:[13,27],width:20,rail:[1,1/4]},{gradient:[-1,1],delta:[-13,27],width:20,rail:[1,1/4]},{gradient:[-1,0],delta:[-27,13],width:20,rail:[1,1/4],color:"lightgreen"},{gradient:[-1,0],delta:[-120,0],width:20,rail:[1,1/4]},{gradient:[-1,-1],delta:[-27,-13],width:20,rail:[1,1/4]},{gradient:[0,-1],delta:[-13,-27],width:20,rail:[1,1/4]},{gradient:[1,-1],delta:[13,-27],width:20,rail:[1,1/4]},{gradient:[1,0],delta:[27,-13],width:20,rail:[1,1/4]}].map(function(t){return new a(t)}),[new s("Alice",{color:"lightgreen",color2:"orange",rgb:[144,238,144]}),new s("Brooklyn",{color:"white",color2:"black",r:3,strokeWidth:3,rgb:[0,0,0]}),new s("Charlotte",{color:"#249E57",color2:"lightgrey",r:3.5,strokeWidth:2,rgb:[36,158,87]}),new s("Dallas",{color:"white",color2:"blue",r:3,strokeWidth:3,rgb:[0,0,255]}),new s("Edison",{color:"lightblue",color2:"cornflowerblue",r:3.5,strokeWidth:2,rgb:[173,216,230]}),new s("Florence",{color:"#1E3258",color2:"#BF1F2D",r:3.5,strokeWidth:2,rgb:[191,31,45]})],{laps:3});t.simulation.stop(),t.init(),n(t),document.getElementById("btnStart").focus(),document.getElementById("btnStart").addEventListener("click",function(e){switch(e.preventDefault(),e.currentTarget.innerText){case"Start":console.log("Sam, start!"),t.simulation.stop(),t.init(),t.simulation.alpha(1),setTimeout(function(e){t.simulation.restart(),e.innerText="Pause",e.disabled=!1,e.focus()},500,e.currentTarget),e.currentTarget.disabled=!0;break;case"Pause":t.simulation.stop(),e.currentTarget.innerText="Play";break;case"Play":t.simulation.restart(),e.currentTarget.innerText="Pause";}}),document.getElementById("btnTick").addEventListener("click",function(e){e.preventDefault(),t.simulation.tick(),t.onTick()})});function a(t){var _this=this;Object.assign(this,{gradient:[1,0],delta:[0,0],width:20,rail:[.5,.5]},t);var e=Math.hypot.apply(Math,_toConsumableArray(this.gradient));var i=Math.acos(this.gradient[0]/e);-1===Math.sign(this.gradient[1])&&(i=2*Math.PI-i),this.α=i,this.force=function(){var t=[];var e=_this;function i(i){t.forEach(function(t){if(0===t.trackAhead.length)return;if(t.trackAhead[0]!==e)return;var a=[e.gradient[0]-t.vx,e.gradient[1]-t.vy],r=Math.hypot.apply(Math,_toConsumableArray(a));a=a.map(function(t){return t/r}),0!==Math.hypot(t.vx,t.vy)&&Math.acos((a[0]*t.vx+a[1]*t.vy)/Math.hypot.apply(Math,_toConsumableArray(a))/Math.hypot(t.vx,t.vy))>Math.PI/2&&(a=[0,0]),a=a.map(function(t,i){return t+e.gradient[i]}),r=Math.hypot.apply(Math,_toConsumableArray(a)),a=a.map(function(t){return t/r}),t.vx+=.2*a[0]*i,t.vy+=.2*a[1]*i;var s=[t.x+t.vx,t.y+t.vy];if(Number.isFinite(e.m)&&Number.isFinite(e.b)&&0!==e.α&&e.α!==Math.PI&&e.α!==2*Math.PI){var _i=e.m*s[0]+e.b;e.α>0&&e.α<Math.PI&&_i<=s[1]&&(t.nextPiece=!0),e.α>Math.PI&&_i>=s[1]&&(t.nextPiece=!0)}else 0===e.α&&e.x<s[0]&&(t.nextPiece=!0),e.α===Math.PI&&e.x>s[0]&&(t.nextPiece=!0);var n=t.trackAhead.slice(-1).pop();if(Number.isFinite(n.m)&&Number.isFinite(n.b)&&0!==n.α&&n.α!==Math.PI&&n.α!==2*Math.PI){var _e=n.m*t.x+n.b;n.α>0&&n.α<Math.PI&&_e>t.y&&(t.previousPiece=!0),n.α>Math.PI&&_e<t.y&&(t.previousPiece=!0)}else 0===n.α&&n.x>t.x&&(t.previousPiece=!0),n.α===Math.PI&&n.x<t.x&&(t.previousPiece=!0);t.previousPiece&&(t.nextPiece=!1)})}return i.initialize=function(e){t=e},i}()}function r(t,e,a,r){var s=d3.forceSimulation();Object.assign(this,{laps:10},r,{gradients:[],rails:[],tick:0,time:0,pos:[]});var n=document.createElementNS(i,"g");n.setAttribute("id","gTrack");var o=document.createElementNS(i,"g");o.setAttribute("id","gCars"),t instanceof SVGElement&&(t.appendChild(n),t.appendChild(o)),Object.defineProperties(this,{simulation:{get:function get(){return s}},svg:{get:function get(){return t}},gTrack:{get:function get(){return n}},gCars:{get:function get(){return o}}}),e instanceof Array&&this.setTrack(e),a instanceof Array&&this.setCars(a)}function s(t,e){var _this2=this;Object.assign(this,{strokeWidth:1,r:4},e,{trackAhead:[],nextPiece:!1,previousPiece:!1,lapTimes:[],time:[]}),Object.defineProperties(this,{name:{enumerable:!0,get:function get(){return t}},radius:{enumerable:!0,get:function get(){return _this2.r+_this2.strokeWidth/2}}})}function n(t){console.log("Sam, let's do this!");var _BABYLON=BABYLON,e=_BABYLON.ArcFollowCamera,i=_BABYLON.ArcRotateCamera,a=_BABYLON.Animation,r=_BABYLON.Color3,s=_BABYLON.Engine,n=_BABYLON.FollowCamera,o=_BABYLON.HemisphericLight,l=_BABYLON.MeshBuilder,h=_BABYLON.Plane,c=_BABYLON.Scene,d=_BABYLON.StandardMaterial,m=_BABYLON.UniversalCamera,u=_BABYLON.Vector3,p=new s(document.querySelector("canvas#replay"),!0),g=new c(p);new o("light1",new u(0,1,0),g);var y=new m("universalCamera",new u(-35,160,-2*t.extrema[1][1]),g),f=new i("rotateCamera",Math.PI/2,Math.PI/2-Math.PI/8,100,new u(-30,4.5,5),g);console.log("Sam, activeCamera:",g.activeCamera);var x=t.extrema[0][1]-t.extrema[0][0]+20,v=t.extrema[1][1]-t.extrema[1][0]+20;v>4*x/5?x=5*v/4:v=4*x/5;var M=l.CreateGround("ground1",{height:v,width:x,subdivisions:2},g);M.position=new u((t.extrema[0][1]+t.extrema[0][0])/2,-.02,-(t.extrema[1][1]+t.extrema[1][0])/2);var w=new d("grass",g);w.diffuseColor=new r(86/255,125/255,70/255),M.material=w;var b=new d("asphalt",g);b.diffuseColor=new r(183/255,181/255,186/255),console.log("Sam, raceTrack:",t),t.gradients.forEach(function(e,i){0===i&&(e.delta=[t.gradients.slice(-1)[0].x,t.gradients.slice(-1)[0].y]);var a=Math.hypot.apply(Math,_toConsumableArray(e.delta)),r=l.CreatePlane("piece".concat(i),{width:e.width,height:a},g);e.gradient=e.gradient.map(function(t){return t/Math.hypot.apply(Math,_toConsumableArray(e.gradient))});e.delta[0],e.gradient[0],e.delta[1],e.gradient[1];r.position=new u(e.x-e.gradient[0]*a/2,0,-e.y+e.gradient[1]*e.width/2);var s=Math.acos(e.gradient[1]/Math.hypot.apply(Math,_toConsumableArray(e.gradient)));-1===Math.sign(e.gradient[0])&&(s=2*Math.PI-s),r.addRotation(Math.PI/2,0,s),r.material=b});var P=t.pos[0].cars,k=t.cars;if(P.forEach(function(t){var e=k.filter(function(e){return e.name===t.name})[0];if(e.sphere=l.CreateSphere("sphere",{segments:16,diameter:2*e.radius},g),"Charlotte"===e.name&&(y.setTarget(new u(t.x,e.radius,-t.y)),f.lockedTarget=e.sphere),e.sphere.position=new u(t.x,e.radius,-t.y),e.rgb instanceof Array){var _t=new d("".concat(e.name,"Material"),g);_t.diffuseColor=_construct(r,_toConsumableArray(e.rgb.map(function(t){return t/255}))),e.sphere.material=_t}}),t.pos.length>1){var _e2=new a("anime","position",30,a.ANIMATIONTYPE_VECTOR3,a.ANIMATIONLOOPMODE_CYCLE),_i2=[];t.pos.forEach(function(t){var e=t.cars.filter(function(t){return"Charlotte"===t.name})[0];_i2.push({frame:5*t.tick,value:new u(e.x,e.radius,-e.y)})}),_e2.setKeys(_i2);var _r=k.filter(function(t){return"Charlotte"===t.name})[0];_r.sphere.animations=[_e2],g.beginAnimation(_r.sphere,0,_i2[_i2.length-1].frame,!0)}var T=0;p.runRenderLoop(function(){g.render(),T++,T%100==50?g.activeCamera=y:T%100==0&&(g.activeCamera=f)}),window.addEventListener("resize",function(){p.resize()})}Object.defineProperties(r.prototype,{init:{enumerable:!0,value:function value(){var _this3=this;if(!(this.svg instanceof SVGElement))throw new Error("RaceTrack.init requires valid svg element!");return this.svg.getElementById("gTrack")||this.svg.appendChild(this.gTrack),this.svg.getElementById("gCars")||this.svg.appendChild(this.gCars),this.simulation.force("fCollide",d3.forceCollide(4)),this.simulation.nodes().forEach(function(t,e){t.lapTimes=[],t.x=-10*(e+1),t.y=-3*Math.pow(-1,e),t.vx=.9,t.vy=0,t.trackAhead=_this3.gradients.slice()}),this.pos=[],this.moveCars(),this.listCars(),this.simulation.alphaDecay(0),this.simulation.velocityDecay(.01),this.simulation.on("tick",function(){_this3.onTick()}),this}},onTick:{value:function value(){var _this4=this;return this.simulation.nodes(this.simulation.nodes()),requestAnimationFrame(function(t){_this4.time=t}),this.tick++,this.moveCars(),this.listCars(),this.cars.every(function(t){return t.lapTimes.length>_this4.laps})?(console.log("Sam, race over?"),console.log("Sam, replay:",this.pos),console.log("Sam, cars:",this.cars),this.simulation.stop(),void n(this)):this}},moveCars:{value:function value(){var _this5=this;return d3.selectAll("#gCars circle").attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),this.simulation.nodes().forEach(function(t,e,i){if(_this5.rails.forEach(function(e){var i=function(t,e){var i=[e.x+e.vx,e.y+e.vy],a=function a(t){return Math.hypot(t.x-i[0],t.y-i[1])},r=t.getTotalLength();var s,n,o,l=16,h=Number.POSITIVE_INFINITY;for(var _e3=0;_e3<=r;_e3+=l){var _i3=t.getPointAtLength(_e3),_r2=a(_i3);_r2<h&&(s=_i3,n=_e3,h=_r2)}if(h>=2*e.radius&&h>=Math.hypot(e.vx,e.vy))return{distance:h};l/=2;for(;l>.5;){var _e4=n-l,_i4=t.getPointAtLength(_e4),c=a(_i4),d=n+l;o=t.getPointAtLength(d);var m=a(o);_e4>=0&&c<h?(s=_i4,n=_e4,h=c):d<=r&&m<h?(s=o,n=d,h=m):l/=2}return{distance:h,after:o,best:s}}(e,t);if(i.distance<=t.radius||i.distance<=Math.hypot(t.vx,t.vy)){var _e5=[i.after.y-i.best.y,i.best.x-i.after.x];var _a=Math.hypot.apply(Math,_toConsumableArray(_e5));_e5=_e5.map(function(t){return t/_a});var _r3=[t.x-i.best.x,t.y-i.best.y];Math.acos((_r3[0]*_e5[0]+_r3[1]*_e5[1])/Math.hypot.apply(Math,_r3))>=Math.PI/2&&(_e5[0]=-_e5[0],_e5[1]=-_e5[1]);var _s=t.vx*_e5[0]+t.vy*_e5[1];if(Math.acos(_s/Math.hypot(t.vx,t.vy))<Math.PI/2)return;var _n=Math.random()+1,o=[],l=0;do{_n+=.05,o=[_n*_s*_e5[0],_n*_s*_e5[1]],l=Math.hypot(t.x+t.vx-o[0]-i.after.x,t.y+t.vy-o[1]-i.after.y)}while(Math.abs((t.vx-o[0])*_e5[0]+(t.vy-o[1])*_e5[1])<=Math.abs(_s)&&l<t.radius&&_n<3);if(_n<2){var _i5=[-_e5[1],_e5[0]];Math.acos((t.vx*_i5[0]+t.vy*_i5[1])/Math.hypot(t.vx,t.vy))>Math.PI/2&&(_i5[0]*=-1,_i5[1]*=-1);var _a2=t.vx*_i5[0]+t.vy*_i5[1];for(_n=.1;Math.hypot(t.vx-o[0],t.vy-o[1])<.6*Math.hypot(t.vx,t.vy)&&_n<1;){_n+=.1,o[0]-=.1*_a2*_i5[0],o[1]-=.1*_a2*_i5[1]}for(;Math.hypot(t.vx-o[0],t.vy-o[1])>Math.hypot(t.vx,t.vy);){o[0]+=.05*_a2*_i5[0],o[1]+=.05*_a2*_i5[1]}}t.vx-=o[0],t.vy-=o[1]}}),t.nextPiece){var _e6=_this5.gradients.indexOf(t.trackAhead[0]);if(!t.time.some(function(i){return i.lap===t.lapTimes.length&&i.piece===_e6})&&(t.time.push({lap:t.lapTimes.length,piece:_e6,tick:_this5.tick,time:_this5.time}),0===_e6&&(t.lapTimes.push(_this5.time),t.lapTimes.length>_this5.laps)))return t.fx=_this5.extrema[0][0],void(t.fy=_this5.extrema[1][0]);t.trackAhead.push(t.trackAhead.shift()),t.nextPiece=!1}t.previousPiece&&(t.trackAhead.unshift(t.trackAhead.pop()),t.previousPiece=!1),(t.x<_this5.extrema[0][0]-10||t.x>_this5.extrema[0][1]+10||t.y<_this5.extrema[1][0]-10||t.y>_this5.extrema[1][1]+10)&&(console.log("Sam, car out of bounds!"),_this5.simulation.stop())}),this.pos.push({tick:this.tick,time:this.time,cars:this.cars.map(function(t){return{name:t.name,radius:t.radius,vx:t.vx,vy:t.vy,x:t.x,y:t.y}})}),this}},setTrack:{enumerable:!0,value:function value(t){var _this6=this;this.gradients=t.filter(function(t){return t instanceof a});var e=[0,0];var r=[[0,0],[0,0]],s=[[],[]];this.rails=new Array(2).fill({});var n=[];this.gTrack.innerHTML="",this.gradients.forEach(function(t,a){e[0]+=t.delta[0],e[1]+=t.delta[1],n.push([e[0],e[1]]),t.x=e[0],t.y=e[1],t.force&&_this6.simulation.force("piece".concat(a),t.force);var o=Math.acos(t.gradient[0]/Math.hypot.apply(Math,_toConsumableArray(t.gradient)));-1===Math.sign(t.gradient[1])&&(o=2*Math.PI-o);var l={x1:e[0]+t.width*Math.sin(o),y1:e[1]-t.width*Math.cos(o),x2:e[0]-t.width*Math.sin(o),y2:e[1]+t.width*Math.cos(o)};t.m=(l.y2-l.y1)/(l.x2-l.x1),t.b=-t.m*l.x1+l.y1;var h=document.createElementNS(i,"line");s[0].push({before:[l.x1-t.width*Math.cos(o)*t.rail[0],l.y1-t.width*Math.sin(o)*t.rail[0]],is:[l.x1,l.y1],after:[l.x1+t.width*Math.cos(o)*t.rail[0],l.y1+t.width*Math.sin(o)*t.rail[0]]}),s[1].push({before:[l.x2-t.width*Math.cos(o)*t.rail[1],l.y2-t.width*Math.sin(o)*t.rail[1]],is:[l.x2,l.y2],after:[l.x2+t.width*Math.cos(o)*t.rail[1],l.y2+t.width*Math.sin(o)*t.rail[1]]}),r[0][0]=Math.min(r[0][0],l.x1,l.x2),r[0][1]=Math.max(r[0][1],l.x1,l.x2),r[1][0]=Math.min(r[1][0],l.y1,l.y2),r[1][1]=Math.max(r[1][1],l.y1,l.y2),Object.entries(l).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),t=_ref2[0],e=_ref2[1];h.setAttribute(t,e)}),h.classList.add("checkpoint"),0===a&&h.classList.add("start-line"),_this6.gTrack.appendChild(h),d3.select("svg #gTrack").append("circle").attr("cx",t.x).attr("cy",t.y).attr("r",0===a?1.5:2).attr("fill",t.color||"whitesmoke").attr("strokeWidth",0===a?"0.5px":"0").attr("stroke",0===a?"white":"none")}),this.extrema=r,s.forEach(function(t,e){t.push(t[0]);var a=document.createElementNS(i,"path"),r=[];t.forEach(function(e,i){0===i?r.push("M".concat(e.is.join(","))):r.push("C".concat([t[i-1].after.join(" "),e.before.join(" "),e.is.join(" ")].join(",")))}),a.setAttribute("d",r.join("")),_this6.gTrack.appendChild(a),_this6.rails[e]=a});var o=r[0][1]-r[0][0]+20,l=r[1][1]-r[1][0]+20,h=r[0][0]-10,c=r[1][0]-10;return l>4*o/5?(o=5*l/4,h=(r[0][0]+r[0][1]-o)/2):(l=4*o/5,c=(r[1][0]+r[1][1]-l)/2),this.svg.setAttribute("viewBox","".concat(h," ").concat(c," ").concat(o," ").concat(l)),d3.select("svg").append("g").selectAll("path").data([n]).enter().append("path").attr("d",d3.line().curve(d3.curveBasisClosed)).classed("lane-line",!0),this}},setCars:{enumerable:!0,value:function value(t){return d3.select("svg #gCars").selectAll("circle").data(t).enter().append("circle").classed("car",!0).attr("fill",function(t){return t.color}).attr("stroke",function(t){return t.color2}).attr("stroke-width",function(t){return t.strokeWidth}).attr("r",function(t){return t.r}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),this.simulation.nodes(t),this.cars=t.slice(),this}},listCars:{enumerable:!0,value:function value(){var _this7=this;var t=[];var e=document.querySelector("ol#positions");return this.cars.sort(function(t,e){return 0===t.time.length&&0===e.time.length?0:0===t.time.length?1:0===e.time.length||t.time.length>e.time.length?-1:t.time.length<e.time.length||t.time[t.time.length-1].time>e.time[e.time.length-1].time?1:t.time[t.time.length-1].time<e.time[e.time.length-1].time?-1:0}).forEach(function(i,a){if(!(i.elPositionList instanceof Element)){i.elPositionList=document.createElement("li");var _t2=document.createElement("span");_t2.classList.add("name"),_t2.innerText=i.name,i.elPositionList.appendChild(_t2);var _e7=document.createElement("span");_e7.classList.add("time"),i.elPositionList.appendChild(_e7)}var r=i.elPositionList;if(i.time.length>1){var _e8=i.time[i.time.length-1];0===a&&(t=i.time.slice());var _s2=r.querySelector(".time");if(0===a){var _t3=((_e8.time-i.time[0].time)/1e3).toFixed(2);_s2.innerText!==_t3&&(_s2.innerText=_t3),_s2.classList.remove("fade-out")}else{var _a3=t.filter(function(t){return t.lap===_e8.lap&&t.piece===_e8.piece})[0];t.indexOf(_a3),t.length;var _r4=(_e8.time-_a3.time)/1e3;_r4=_r4>0?"+".concat(_r4.toFixed(2)):_r4.toFixed(2),_s2.innerText!==_r4&&(_s2.classList.remove("fade-out"),i.lapTimes.length<_this7.laps&&setTimeout(function(){_s2.classList.add("fade-out")},1e3),_s2.innerText=_r4)}}r.style.order=a,r.setAttribute("order",a+1),e.contains(r)||e.appendChild(r)}),this}}}),Object.defineProperties(s.prototype,{})}]);